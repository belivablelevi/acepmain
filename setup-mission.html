<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ACEP Mission Setup</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 900px;
      margin: 50px auto;
      padding: 20px;
      background: #f0fdf4;
    }
    .container {
      background: white;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    }
    h1 {
      color: #059669;
      margin-bottom: 10px;
    }
    .subtitle {
      color: #6b7280;
      margin-bottom: 30px;
    }
    .status {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-weight: 600;
    }
    .info {
      background: #dbeafe;
      color: #1e40af;
      border-left: 4px solid #3b82f6;
    }
    .success {
      background: #d1fae5;
      color: #065f46;
      border-left: 4px solid #059669;
    }
    .error {
      background: #fee2e2;
      color: #991b1b;
      border-left: 4px solid #ef4444;
    }
    .warning {
      background: #fef3c7;
      color: #92400e;
      border-left: 4px solid #f59e0b;
    }
    .config-section {
      margin: 30px 0;
      padding: 20px;
      background: #f9fafb;
      border-radius: 8px;
      border: 2px dashed #d1d5db;
    }
    textarea {
      width: 100%;
      height: 200px;
      padding: 15px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      resize: vertical;
    }
    textarea:focus {
      outline: none;
      border-color: #059669;
    }
    button {
      background: #059669;
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
      margin-top: 20px;
    }
    button:hover {
      background: #047857;
    }
    button:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }
    .progress {
      margin-top: 20px;
    }
    .progress-bar {
      width: 100%;
      height: 30px;
      background: #e5e7eb;
      border-radius: 15px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #059669, #10b981);
      width: 0%;
      transition: width 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
    }
    .mission-list {
      margin-top: 20px;
      font-size: 14px;
      color: #6b7280;
      max-height: 400px;
      overflow-y: auto;
    }
    .mission-item {
      padding: 8px;
      border-bottom: 1px solid #f3f4f6;
    }
    .mission-item.done {
      color: #059669;
    }
    code {
      background: #f3f4f6;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
    }
    .step {
      margin-bottom: 20px;
      padding: 15px;
      background: #f0fdf4;
      border-left: 4px solid #059669;
      border-radius: 8px;
    }
    .step h3 {
      margin: 0 0 10px 0;
      color: #059669;
    }
  </style>

</head>
<body>
  <div class="container">
    <h1>üöÄ ACEP Mission Setup</h1>
    <p class="subtitle">Paste your Firebase config and add all 20 missions in one click!</p>

```
<div id="status" class="status info">
  ‚ÑπÔ∏è Follow the steps below to automatically add all missions
</div>

<div class="step">
  <h3>Step 1: Get Your Firebase Config</h3>
  <ol>
    <li>Go to <a href="https://console.firebase.google.com" target="_blank">Firebase Console</a></li>
    <li>Click your project</li>
    <li>Click gear icon ‚öôÔ∏è ‚Üí Project settings</li>
    <li>Scroll to "Your apps" section</li>
    <li>Find the <code>firebaseConfig</code> object</li>
    <li>Copy the ENTIRE config (should look like example below)</li>
  </ol>
</div>

<div class="config-section">
  <label style="display: block; font-weight: 700; margin-bottom: 10px; color: #111827;">
    Paste Your Firebase Config Here:
  </label>
  <textarea id="configInput" placeholder='{
```

apiKey: ‚ÄúAIzaSyC-xxxxxxxxxxxxxx‚Äù,
authDomain: ‚Äúyour-project.firebaseapp.com‚Äù,
projectId: ‚Äúyour-project‚Äù,
storageBucket: ‚Äúyour-project.appspot.com‚Äù,
messagingSenderId: ‚Äú123456789‚Äù,
appId: ‚Äú1:123456789:web:xxxxx‚Äù
}‚Äô></textarea>
<div class="status warning" style="margin-top: 15px; font-size: 14px;">
‚ö†Ô∏è Make sure to paste the ENTIRE config object including the curly braces { }
</div>
</div>

```
<button id="setupBtn" onclick="setupMissions()">
  üéØ Initialize Firebase & Add All 20 Missions!
</button>

<div id="progress" class="progress" style="display: none;">
  <div class="progress-bar">
    <div id="progressFill" class="progress-fill">0%</div>
  </div>
  <div id="missionList" class="mission-list"></div>
</div>
```

  </div>

  <script>
    let db = null;
    
    const missions = [
      {
        id: 'mission1',
        title: 'Toxic Trail Tracker',
        category: 'industrial',
        difficulty: 'medium',
        points: 150,
        active: true,
        description: 'Become a pollution detective! Find and document suspicious discharge pipes, discolored water, or chemical smells near industrial sites. Your photos could trigger environmental inspections and protect waterways!',
        requirements: { photos: 2, description: true, location: true }
      },
      {
        id: 'mission2',
        title: 'Water Quality Detective',
        category: 'wastewater',
        difficulty: 'hard',
        points: 200,
        active: true,
        description: 'Become a citizen scientist! Use simple pH test strips to check your local stream, pond, or lake for hidden pollution. Your data could reveal pollution hotspots and protect thousands of aquatic animals!',
        requirements: { photos: 3, description: true, location: true }
      },
      {
        id: 'mission3',
        title: 'Algae Bloom Alerter',
        category: 'eutrophication',
        difficulty: 'easy',
        points: 125,
        active: true,
        description: 'Toxic algae blooms can kill pets in minutes! Scout local ponds and lakes for dangerous blue-green algae. Your photos warn the community and protect wildlife. Safety first - never touch the water!',
        requirements: { photos: 2, description: true, location: true }
      },
      {
        id: 'mission4',
        title: 'Hazardous Waste Hunter',
        category: 'harmful',
        difficulty: 'medium',
        points: 175,
        active: true,
        description: 'Spot illegally dumped hazardous waste before it causes major damage! Look for paint cans, batteries, chemicals, or electronics dumped in remote areas. Never touch them - just photograph and report location!',
        requirements: { photos: 2, description: true, location: true }
      },
      {
        id: 'mission5',
        title: 'Storm Drain Steward',
        category: 'pollution',
        difficulty: 'easy',
        points: 100,
        active: true,
        description: 'Storm drains flow directly to rivers! Adopt a drain near your home, clear debris weekly, and spot pollution. You\'re a guardian of the river ecosystem downstream!',
        requirements: { photos: 2, description: true, location: true }
      },
      {
        id: 'mission6',
        title: 'Farm Runoff Ranger',
        category: 'industrial',
        difficulty: 'hard',
        points: 250,
        active: true,
        description: 'Agricultural runoff is a major pollution source! From public roads, photograph visible muddy water, bare soil erosion, or green water downstream from farms. Stay on public property and be respectful!',
        requirements: { photos: 3, description: true, location: true }
      },
      {
        id: 'mission7',
        title: 'Plastic Pollution Purge',
        category: 'pollution',
        difficulty: 'medium',
        points: 180,
        active: true,
        description: 'Conduct a waterway cleanup! Remove plastic pollution from river banks or lake shores. Sort items by type, count them, and share your totals. Every piece removed = one less threat to wildlife!',
        requirements: { photos: 4, description: true, location: true }
      },
      {
        id: 'mission8',
        title: 'Wastewater Educator',
        category: 'wastewater',
        difficulty: 'medium',
        points: 130,
        active: true,
        description: 'Create educational content teaching people what never to flush or pour down drains! Make a poster, video, or social media post. Education prevents pollution before it starts!',
        requirements: { photos: 2, description: true, location: false }
      },
      {
        id: 'mission9',
        title: 'Chemical Spill Responder',
        category: 'harmful',
        difficulty: 'hard',
        points: 300,
        active: true,
        description: 'EMERGENCY! Chemical spills can devastate ecosystems in hours. If you spot suspicious discharge, strange colored water, or dead fish, photograph from a safe distance and immediately report to Environment Canada: 1-866-283-2333',
        requirements: { photos: 2, description: true, location: true }
      },
      {
        id: 'mission10',
        title: 'Nutrient Pollution Preventer',
        category: 'eutrophication',
        difficulty: 'easy',
        points: 140,
        active: true,
        description: 'Excess fertilizer creates toxic algae blooms! Document over-fertilization near waterways - bright green grass, fertilizer on pavement, or recent application within 3 meters of water.',
        requirements: { photos: 2, description: true, location: true }
      },
      {
        id: 'mission11',
        title: 'Battery Recycling Hero',
        category: 'harmful',
        difficulty: 'easy',
        points: 100,
        active: true,
        description: 'Dead batteries leak toxic chemicals! Collect old batteries from your home and neighbors, then take them to a recycling depot (Canadian Tire, Best Buy, municipal depot). One battery can contaminate 600,000 liters of water!',
        requirements: { photos: 2, description: true, location: false }
      },
      {
        id: 'mission12',
        title: 'Neighborhood Litter Patrol',
        category: 'pollution',
        difficulty: 'easy',
        points: 75,
        active: true,
        description: 'Keep your street clean! Grab gloves and a bag, spend 10-30 minutes picking up litter around your block. Every piece you collect is one less thing reaching waterways!',
        requirements: { photos: 2, description: true, location: false }
      },
      {
        id: 'mission13',
        title: 'Water Saver Challenge',
        category: 'wastewater',
        difficulty: 'easy',
        points: 90,
        active: true,
        description: 'Challenge yourself to save water for one week! Try shorter showers, turn off tap while brushing, catch shower warmup water, and fix leaks. Track your savings and protect freshwater!',
        requirements: { photos: 3, description: true, location: false }
      },
      {
        id: 'mission14',
        title: 'Recycling Detective',
        category: 'pollution',
        difficulty: 'easy',
        points: 85,
        active: true,
        description: 'Audit your family\'s recycling! Check for common mistakes like plastic bags, greasy pizza boxes, or contaminated items. Create a simple guide and teach your family to recycle correctly!',
        requirements: { photos: 2, description: true, location: false }
      },
      {
        id: 'mission15',
        title: 'Backyard Wildlife Helper',
        category: 'eutrophication',
        difficulty: 'easy',
        points: 110,
        active: true,
        description: 'Turn your yard into a wildlife haven! Add a birdbath or bee water station, plant native flowers, and create habitats. Your backyard becomes a feeding station and safe space for birds, bees, and butterflies!',
        requirements: { photos: 3, description: true, location: false }
      },
      {
        id: 'mission16',
        title: 'Compost Champion',
        category: 'pollution',
        difficulty: 'easy',
        points: 95,
        active: true,
        description: 'Food waste in landfills creates methane - a powerful greenhouse gas! Start composting at home (outdoor bin, worm bin, or city green bin). Turn trash into treasure!',
        requirements: { photos: 3, description: true, location: false }
      },
      {
        id: 'mission17',
        title: 'Plastic-Free Lunch Week',
        category: 'pollution',
        difficulty: 'easy',
        points: 80,
        active: true,
        description: 'Pack zero-waste lunches for 5 school days! Use reusable containers, cloth napkins, and refillable water bottles. No plastic wrap, no baggies, no juice boxes. Can you do it?',
        requirements: { photos: 3, description: true, location: false }
      },
      {
        id: 'mission18',
        title: 'Storm Drain Art Guardian',
        category: 'wastewater',
        difficulty: 'easy',
        points: 120,
        active: true,
        description: 'Storm drains flow to rivers! With city permission, paint educational art near drains (fish, "flows to river" messages). Your art teaches thousands of people not to pollute!',
        requirements: { photos: 3, description: true, location: true }
      },
      {
        id: 'mission19',
        title: 'Second-Hand Treasure Hunt',
        category: 'pollution',
        difficulty: 'easy',
        points: 70,
        active: true,
        description: 'Find 5 items at thrift stores, garage sales, or online instead of buying new! Reduce manufacturing waste, save money, and find unique treasures. Every second-hand purchase prevents pollution!',
        requirements: { photos: 3, description: true, location: false }
      },
      {
        id: 'mission20',
        title: 'Energy Vampire Hunter',
        category: 'pollution',
        difficulty: 'easy',
        points: 105,
        active: true,
        description: 'Hunt phantom power drains! Devices use electricity even when "off". Find energy vampires (phone chargers, TVs, gaming consoles), unplug them, and use power bars. Slash electricity waste!',
        requirements: { photos: 3, description: true, location: false }
      }
    ];

    async function setupMissions() {
      const btn = document.getElementById('setupBtn');
      const status = document.getElementById('status');
      const progress = document.getElementById('progress');
      const progressFill = document.getElementById('progressFill');
      const missionList = document.getElementById('missionList');
      const configInput = document.getElementById('configInput').value.trim();
      
      // Validate input
      if (!configInput) {
        status.className = 'status error';
        status.textContent = '‚ùå Please paste your Firebase config first!';
        return;
      }
      
      btn.disabled = true;
      progress.style.display = 'block';
      
      try {
        // Parse and initialize Firebase
        status.className = 'status info';
        status.textContent = 'üîÑ Initializing Firebase...';
        
        let firebaseConfig;
        try {
          // Try to parse as JSON
          firebaseConfig = JSON.parse(configInput);
        } catch (e) {
          // If not valid JSON, try to extract object
          const match = configInput.match(/\{[\s\S]*\}/);
          if (match) {
            // Convert JavaScript object notation to JSON
            const cleaned = match[0]
              .replace(/(\w+):/g, '"$1":')  // Add quotes to keys
              .replace(/'/g, '"');           // Replace single quotes with double
            firebaseConfig = JSON.parse(cleaned);
          } else {
            throw new Error('Could not parse config. Make sure you pasted the entire config object.');
          }
        }
        
        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        
        status.className = 'status success';
        status.textContent = '‚úÖ Firebase connected! Adding missions...';
        
        let completed = 0;
        missionList.innerHTML = '';
        
        for (const mission of missions) {
          try {
            // Add mission to Firestore
            await db.collection('challenges').doc(mission.id).set(mission);
            
            completed++;
            const percent = Math.round((completed / missions.length) * 100);
            progressFill.style.width = percent + '%';
            progressFill.textContent = percent + '%';
            
            // Update list
            const item = document.createElement('div');
            item.className = 'mission-item done';
            item.textContent = `‚úÖ ${mission.title} (${mission.points} pts)`;
            missionList.appendChild(item);
            
          } catch (error) {
            console.error(`Error adding ${mission.id}:`, error);
            const item = document.createElement('div');
            item.className = 'mission-item';
            item.style.color = '#ef4444';
            item.textContent = `‚ùå ${mission.title} - Error: ${error.message}`;
            missionList.appendChild(item);
          }
        }
        
        status.className = 'status success';
        status.innerHTML = `üéâ SUCCESS! Added all ${completed} missions!<br><br>‚úÖ Go to your website and check missions page!<br>‚úÖ You can close this page now!`;
        btn.textContent = '‚úÖ All Missions Added!';
        
      } catch (error) {
        status.className = 'status error';
        status.innerHTML = `‚ùå Error: ${error.message}<br><br>Make sure you pasted the correct Firebase config!`;
        btn.disabled = false;
        btn.textContent = 'üîÑ Try Again';
        console.error('Setup error:', error);
      }
    }
  </script>

</body>
</html>
