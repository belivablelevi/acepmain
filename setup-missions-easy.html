<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ACEP Mission Setup - Easy Version</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1000px;
      margin: 30px auto;
      padding: 20px;
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
    }
    .container {
      background: white;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.15);
    }
    h1 {
      color: #059669;
      margin-bottom: 10px;
      font-size: 2.5rem;
    }
    .subtitle {
      color: #6b7280;
      margin-bottom: 30px;
      font-size: 1.125rem;
    }
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      border-bottom: 2px solid #e5e7eb;
    }
    .tab {
      padding: 15px 30px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      color: #6b7280;
      border-bottom: 3px solid transparent;
      transition: all 0.2s;
    }
    .tab.active {
      color: #059669;
      border-bottom-color: #059669;
    }
    .tab:hover {
      color: #059669;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    .status {
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 25px;
      font-weight: 600;
      font-size: 15px;
      line-height: 1.6;
    }
    .info {
      background: #dbeafe;
      color: #1e40af;
      border-left: 5px solid #3b82f6;
    }
    .success {
      background: #d1fae5;
      color: #065f46;
      border-left: 5px solid #059669;
    }
    .error {
      background: #fee2e2;
      color: #991b1b;
      border-left: 5px solid #ef4444;
    }
    .input-group {
      margin-bottom: 20px;
    }
    .input-group label {
      display: block;
      font-weight: 700;
      margin-bottom: 8px;
      color: #111827;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    input[type="text"] {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 14px;
      font-family: 'Courier New', monospace;
      transition: border 0.2s;
    }
    input[type="text"]:focus {
      outline: none;
      border-color: #059669;
    }
    input[type="text"]::placeholder {
      color: #9ca3af;
    }
    .paste-box {
      position: relative;
    }
    textarea {
      width: 100%;
      height: 200px;
      padding: 15px;
      border: 3px dashed #d1d5db;
      border-radius: 12px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      resize: vertical;
      transition: all 0.2s;
    }
    textarea:focus {
      outline: none;
      border-color: #059669;
      border-style: solid;
      background: #f0fdf4;
    }
    textarea::placeholder {
      color: #9ca3af;
    }
    .paste-hint {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
      text-align: center;
      color: #9ca3af;
      font-size: 18px;
      font-weight: 600;
    }
    textarea:not(:placeholder-shown) + .paste-hint {
      display: none;
    }
    button {
      background: linear-gradient(135deg, #059669, #10b981);
      color: white;
      border: none;
      padding: 18px 40px;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 800;
      cursor: pointer;
      width: 100%;
      margin-top: 25px;
      box-shadow: 0 10px 30px rgba(5, 150, 105, 0.3);
      transition: all 0.2s;
    }
    button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 15px 40px rgba(5, 150, 105, 0.4);
    }
    button:disabled {
      background: linear-gradient(135deg, #9ca3af, #d1d5db);
      cursor: not-allowed;
      box-shadow: none;
    }
    .progress {
      margin-top: 30px;
    }
    .progress-bar {
      width: 100%;
      height: 40px;
      background: #e5e7eb;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.1);
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #059669, #10b981, #34d399);
      width: 0%;
      transition: width 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 800;
      font-size: 16px;
    }
    .mission-list {
      margin-top: 25px;
      font-size: 14px;
      color: #6b7280;
      max-height: 400px;
      overflow-y: auto;
      padding: 15px;
      background: #f9fafb;
      border-radius: 8px;
    }
    .mission-item {
      padding: 10px;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .mission-item:last-child {
      border-bottom: none;
    }
    .mission-item.done {
      color: #059669;
    }
    .helper {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      font-size: 14px;
      color: #92400e;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üöÄ Mission Setup</h1>
    <p class="subtitle">Choose your method: Paste entire config OR enter each field separately</p>
    
    <div id="status" class="status info">
      ‚ÑπÔ∏è Choose a method below to get started
    </div>
    
    <!-- Tabs -->
    <div class="tabs">
      <button class="tab active" onclick="switchTab('paste')">üìã Paste Config (Easier)</button>
      <button class="tab" onclick="switchTab('manual')">‚úçÔ∏è Type Each Field</button>
    </div>
    
    <!-- Tab 1: Paste Method -->
    <div id="pasteTab" class="tab-content active">
      <h3 style="margin-bottom: 15px;">Method 1: Paste Your Entire Firebase Config</h3>
      
      <div class="input-group">
        <label>Click in the box below and press Ctrl+V (or Cmd+V on Mac) to paste:</label>
        <div class="paste-box">
          <textarea 
            id="configPaste" 
            placeholder=""
            onclick="this.focus(); document.getElementById('pasteStatus').textContent = 'üëÜ Now press Ctrl+V (or Cmd+V) to paste!'"
          ></textarea>
          <div class="paste-hint">üëÜ Click here, then paste (Ctrl+V)</div>
        </div>
        <div id="pasteStatus" class="helper" style="margin-top: 10px;">
          üí° Go to Firebase Console ‚Üí Project Settings ‚Üí Find the firebaseConfig object ‚Üí Copy it ‚Üí Come back here ‚Üí Click in box above ‚Üí Press Ctrl+V
        </div>
      </div>
      
      <button onclick="setupWithPaste()">
        üéØ Add All 20 Missions Now!
      </button>
    </div>
    
    <!-- Tab 2: Manual Entry Method -->
    <div id="manualTab" class="tab-content">
      <h3 style="margin-bottom: 15px;">Method 2: Enter Each Field from Your Firebase Config</h3>
      
      <div class="input-group">
        <label>API Key</label>
        <input type="text" id="apiKey" placeholder="AIzaSyC-xxxxxxxxxxxxxx">
      </div>
      
      <div class="input-group">
        <label>Auth Domain</label>
        <input type="text" id="authDomain" placeholder="your-project.firebaseapp.com">
      </div>
      
      <div class="input-group">
        <label>Project ID</label>
        <input type="text" id="projectId" placeholder="your-project">
      </div>
      
      <div class="input-group">
        <label>Storage Bucket</label>
        <input type="text" id="storageBucket" placeholder="your-project.appspot.com">
      </div>
      
      <div class="input-group">
        <label>Messaging Sender ID</label>
        <input type="text" id="messagingSenderId" placeholder="123456789">
      </div>
      
      <div class="input-group">
        <label>App ID</label>
        <input type="text" id="appId" placeholder="1:123456789:web:xxxxx">
      </div>
      
      <button onclick="setupWithManual()">
        üéØ Add All 20 Missions Now!
      </button>
    </div>
    
    <div id="progress" class="progress" style="display: none;">
      <div class="progress-bar">
        <div id="progressFill" class="progress-fill">0%</div>
      </div>
      <div id="missionList" class="mission-list"></div>
    </div>
  </div>

  <script>
    let db = null;
    
    const missions = [
      { id: 'mission1', title: 'Toxic Trail Tracker', category: 'industrial', difficulty: 'medium', points: 150, active: true, description: 'Become a pollution detective! Find and document suspicious discharge pipes, discolored water, or chemical smells near industrial sites. Your photos could trigger environmental inspections and protect waterways!', requirements: { photos: 2, description: true, location: true } },
      { id: 'mission2', title: 'Water Quality Detective', category: 'wastewater', difficulty: 'hard', points: 200, active: true, description: 'Become a citizen scientist! Use simple pH test strips to check your local stream, pond, or lake for hidden pollution. Your data could reveal pollution hotspots and protect thousands of aquatic animals!', requirements: { photos: 3, description: true, location: true } },
      { id: 'mission3', title: 'Algae Bloom Alerter', category: 'eutrophication', difficulty: 'easy', points: 125, active: true, description: 'Toxic algae blooms can kill pets in minutes! Scout local ponds and lakes for dangerous blue-green algae. Your photos warn the community and protect wildlife. Safety first - never touch the water!', requirements: { photos: 2, description: true, location: true } },
      { id: 'mission4', title: 'Hazardous Waste Hunter', category: 'harmful', difficulty: 'medium', points: 175, active: true, description: 'Spot illegally dumped hazardous waste before it causes major damage! Look for paint cans, batteries, chemicals, or electronics dumped in remote areas. Never touch them - just photograph and report location!', requirements: { photos: 2, description: true, location: true } },
      { id: 'mission5', title: 'Storm Drain Steward', category: 'pollution', difficulty: 'easy', points: 100, active: true, description: 'Storm drains flow directly to rivers! Adopt a drain near your home, clear debris weekly, and spot pollution. You\'re a guardian of the river ecosystem downstream!', requirements: { photos: 2, description: true, location: true } },
      { id: 'mission6', title: 'Farm Runoff Ranger', category: 'industrial', difficulty: 'hard', points: 250, active: true, description: 'Agricultural runoff is a major pollution source! From public roads, photograph visible muddy water, bare soil erosion, or green water downstream from farms. Stay on public property and be respectful!', requirements: { photos: 3, description: true, location: true } },
      { id: 'mission7', title: 'Plastic Pollution Purge', category: 'pollution', difficulty: 'medium', points: 180, active: true, description: 'Conduct a waterway cleanup! Remove plastic pollution from river banks or lake shores. Sort items by type, count them, and share your totals. Every piece removed = one less threat to wildlife!', requirements: { photos: 4, description: true, location: true } },
      { id: 'mission8', title: 'Wastewater Educator', category: 'wastewater', difficulty: 'medium', points: 130, active: true, description: 'Create educational content teaching people what never to flush or pour down drains! Make a poster, video, or social media post. Education prevents pollution before it starts!', requirements: { photos: 2, description: true, location: false } },
      { id: 'mission9', title: 'Chemical Spill Responder', category: 'harmful', difficulty: 'hard', points: 300, active: true, description: 'EMERGENCY! Chemical spills can devastate ecosystems in hours. If you spot suspicious discharge, strange colored water, or dead fish, photograph from a safe distance and immediately report to Environment Canada: 1-866-283-2333', requirements: { photos: 2, description: true, location: true } },
      { id: 'mission10', title: 'Nutrient Pollution Preventer', category: 'eutrophication', difficulty: 'easy', points: 140, active: true, description: 'Excess fertilizer creates toxic algae blooms! Document over-fertilization near waterways - bright green grass, fertilizer on pavement, or recent application within 3 meters of water.', requirements: { photos: 2, description: true, location: true } },
      { id: 'mission11', title: 'Battery Recycling Hero', category: 'harmful', difficulty: 'easy', points: 100, active: true, description: 'Dead batteries leak toxic chemicals! Collect old batteries from your home and neighbors, then take them to a recycling depot (Canadian Tire, Best Buy, municipal depot). One battery can contaminate 600,000 liters of water!', requirements: { photos: 2, description: true, location: false } },
      { id: 'mission12', title: 'Neighborhood Litter Patrol', category: 'pollution', difficulty: 'easy', points: 75, active: true, description: 'Keep your street clean! Grab gloves and a bag, spend 10-30 minutes picking up litter around your block. Every piece you collect is one less thing reaching waterways!', requirements: { photos: 2, description: true, location: false } },
      { id: 'mission13', title: 'Water Saver Challenge', category: 'wastewater', difficulty: 'easy', points: 90, active: true, description: 'Challenge yourself to save water for one week! Try shorter showers, turn off tap while brushing, catch shower warmup water, and fix leaks. Track your savings and protect freshwater!', requirements: { photos: 3, description: true, location: false } },
      { id: 'mission14', title: 'Recycling Detective', category: 'pollution', difficulty: 'easy', points: 85, active: true, description: 'Audit your family\'s recycling! Check for common mistakes like plastic bags, greasy pizza boxes, or contaminated items. Create a simple guide and teach your family to recycle correctly!', requirements: { photos: 2, description: true, location: false } },
      { id: 'mission15', title: 'Backyard Wildlife Helper', category: 'eutrophication', difficulty: 'easy', points: 110, active: true, description: 'Turn your yard into a wildlife haven! Add a birdbath or bee water station, plant native flowers, and create habitats. Your backyard becomes a feeding station and safe space for birds, bees, and butterflies!', requirements: { photos: 3, description: true, location: false } },
      { id: 'mission16', title: 'Compost Champion', category: 'pollution', difficulty: 'easy', points: 95, active: true, description: 'Food waste in landfills creates methane - a powerful greenhouse gas! Start composting at home (outdoor bin, worm bin, or city green bin). Turn trash into treasure!', requirements: { photos: 3, description: true, location: false } },
      { id: 'mission17', title: 'Plastic-Free Lunch Week', category: 'pollution', difficulty: 'easy', points: 80, active: true, description: 'Pack zero-waste lunches for 5 school days! Use reusable containers, cloth napkins, and refillable water bottles. No plastic wrap, no baggies, no juice boxes. Can you do it?', requirements: { photos: 3, description: true, location: false } },
      { id: 'mission18', title: 'Storm Drain Art Guardian', category: 'wastewater', difficulty: 'easy', points: 120, active: true, description: 'Storm drains flow to rivers! With city permission, paint educational art near drains (fish, "flows to river" messages). Your art teaches thousands of people not to pollute!', requirements: { photos: 3, description: true, location: true } },
      { id: 'mission19', title: 'Second-Hand Treasure Hunt', category: 'pollution', difficulty: 'easy', points: 70, active: true, description: 'Find 5 items at thrift stores, garage sales, or online instead of buying new! Reduce manufacturing waste, save money, and find unique treasures. Every second-hand purchase prevents pollution!', requirements: { photos: 3, description: true, location: false } },
      { id: 'mission20', title: 'Energy Vampire Hunter', category: 'pollution', difficulty: 'easy', points: 105, active: true, description: 'Hunt phantom power drains! Devices use electricity even when "off". Find energy vampires (phone chargers, TVs, gaming consoles), unplug them, and use power bars. Slash electricity waste!', requirements: { photos: 3, description: true, location: false } }
    ];

    function switchTab(tab) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      
      if (tab === 'paste') {
        document.querySelectorAll('.tab')[0].classList.add('active');
        document.getElementById('pasteTab').classList.add('active');
      } else {
        document.querySelectorAll('.tab')[1].classList.add('active');
        document.getElementById('manualTab').classList.add('active');
      }
    }

    async function setupWithPaste() {
      const configInput = document.getElementById('configPaste').value.trim();
      
      if (!configInput) {
        showStatus('error', '‚ùå Please paste your Firebase config first! Click in the box and press Ctrl+V');
        return;
      }
      
      let firebaseConfig;
      try {
        firebaseConfig = JSON.parse(configInput);
      } catch (e) {
        const match = configInput.match(/\{[\s\S]*\}/);
        if (match) {
          const cleaned = match[0]
            .replace(/(\w+):/g, '"$1":')
            .replace(/'/g, '"');
          firebaseConfig = JSON.parse(cleaned);
        } else {
          showStatus('error', '‚ùå Could not understand the config. Make sure you copied the ENTIRE firebaseConfig object from Firebase Console!');
          return;
        }
      }
      
      await runSetup(firebaseConfig);
    }

    async function setupWithManual() {
      const firebaseConfig = {
        apiKey: document.getElementById('apiKey').value.trim(),
        authDomain: document.getElementById('authDomain').value.trim(),
        projectId: document.getElementById('projectId').value.trim(),
        storageBucket: document.getElementById('storageBucket').value.trim(),
        messagingSenderId: document.getElementById('messagingSenderId').value.trim(),
        appId: document.getElementById('appId').value.trim()
      };
      
      if (!firebaseConfig.apiKey || !firebaseConfig.projectId || !firebaseConfig.appId) {
        showStatus('error', '‚ùå Please fill in at least: API Key, Project ID, and App ID!');
        return;
      }
      
      await runSetup(firebaseConfig);
    }

    async function runSetup(firebaseConfig) {
      const btn = event.target;
      const progress = document.getElementById('progress');
      const progressFill = document.getElementById('progressFill');
      const missionList = document.getElementById('missionList');
      
      btn.disabled = true;
      progress.style.display = 'block';
      
      try {
        showStatus('info', 'üîÑ Connecting to Firebase...');
        
        const app = firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        
        showStatus('success', '‚úÖ Connected! Adding all 20 missions...');
        
        let completed = 0;
        missionList.innerHTML = '';
        
        for (const mission of missions) {
          try {
            await db.collection('challenges').doc(mission.id).set(mission);
            
            completed++;
            const percent = Math.round((completed / missions.length) * 100);
            progressFill.style.width = percent + '%';
            progressFill.textContent = percent + '%';
            
            const item = document.createElement('div');
            item.className = 'mission-item done';
            item.innerHTML = `<span style="font-size: 20px;">‚úÖ</span> ${mission.title} (${mission.points} pts)`;
            missionList.appendChild(item);
            
          } catch (error) {
            console.error(`Error adding ${mission.id}:`, error);
            const item = document.createElement('div');
            item.className = 'mission-item';
            item.style.color = '#ef4444';
            item.innerHTML = `<span style="font-size: 20px;">‚ùå</span> ${mission.title} - Error: ${error.message}`;
            missionList.appendChild(item);
          }
        }
        
        showStatus('success', `üéâ PERFECT! All ${completed} missions added successfully!<br><br>‚úÖ Go check your missions page now!<br>‚úÖ You can close this page!`);
        btn.textContent = '‚úÖ Complete!';
        
      } catch (error) {
        showStatus('error', `‚ùå Error: ${error.message}<br><br>Make sure your Firebase config is correct!`);
        btn.disabled = false;
        console.error('Setup error:', error);
      }
    }

    function showStatus(type, message) {
      const status = document.getElementById('status');
      status.className = 'status ' + type;
      status.innerHTML = message;
    }
  </script>
</body>
</html>
